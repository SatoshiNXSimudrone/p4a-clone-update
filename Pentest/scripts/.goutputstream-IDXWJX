 #!/bin/bash
function scan1
      {
      clear
      cat /sdcard/Pentest/files/header.txt
      echo""
      botbrew tcpdump -i eth0
      echo ""
      echo "Press any Key to proceed"
      read temp
      }
function scan2
      {
      clear
      cat /sdcard/Pentest/files/header.txt
      echo""
      botbrew tcpdump -A -i eth0
      echo ""
      echo "Press any Key to proceed"
      read temp	
      }
function scan3
      {
      clear
      cat /sdcard/Pentest/files/header.txt
      echo""
      botbrew tcpdump -XX -i eth0
      echo ""
      echo "Press any Key to proceed"
      read temp
      }
function scan4
      {
      clear
      cat /sdcard/Pentest/files/header.txt
      echo""
      botbrew /sdcard/Pentest/files/tcpdump -n -i eth0
      echo ""
      echo "Press any Key to proceed"
      read temp
     }
      
function scan5
      {
      clear
      cat /sdcard/Pentest/files/header.txt
      echo""
      botbrew  tcpdump -i eth0 port 22
      echo ""
      echo "Press any Key to proceed"
      read temp
      }      
function WTF
      {
      	clear
        dialog --inputbox \
		"Enter name for file" 0 0 2>inputbox.txt.$$
		retval=$?
		echo $retval
		fN=`cat inputbox.txt.$$`
		rm  inputbox.txt.$$
		case $retval in
		0)
		botbrew tcpdump -w /sdcard/Pentest/tmp/tcpdump/$fN.pcap -i eth0
        echo ""
        echo "Press any Key to proceed"
        read temp;;
		1)
		echo "Cancel pressed.";;
		esac
      }
function RTF
      {
      clear
       dialog --inputbox \
		"Enter name for file" 0 0 2>inputbox.txt.$$
		retval=$?
		echo $retval
		fN=`cat inputbox.txt.$$`
		rm  inputbox.txt.$$
		case $retval in
		0)
		botbrew tcpdump botbrew tcpdump -tttt -r sdcard/Pentest/tmp/tcpdump/$fN.pcap
        echo ""
        echo "Press any Key to proceed"
        read temp ;;
		1)
		echo "Cancel pressed.";;
		esac
      }
      
function CMD
      {
      clear
      cat /sdcard/Pentest/files/header.txt
      echo ""
      echo ""
      echo "TEXT INTERFACE ONLY !"
      echo ""
      echo "Enter tcpdump command"
      echo "without <tcpdump> pefix"
      echo "i.e <-A -i eth0> "
      read cmd
      botbrew tcpdump $cmd
      echo ""
      echo "Press any Key to proceed"
      read temp
      }       

while :
do
# Dialog utility to display options list

    dialog --clear --backtitle "P4A SIMUDRONES NX" --title "TCPDUMP OPTIONS
    " \
    --menu "Use [UP/DOWN] key to move" 12 60 6 \
    "SCAN1" "tcpdump -XX -i eth0" \
    "SCAN2" "tcpdump -A -i eth0" \
    "SCAN3" "tcpdump -XX -i eth0" \
    "SCAN4" "tcpdump -n -i eth0" \
    "SCAN5"  "tcpdump -i eth0 port 22" \
    "WTF1"    "Write Scan to File" \
    "RTF1"    "Read from File" \
    "CMD1"    "Enter Custom command" \
    "EXIT"   "TO EXIT" 2> menuchoices.txt.$$

    retopt=$?
    choice=`cat menuchoices.txt.$$`
 rm menuchoices.txt.$$

    case $retopt in

           0) case $choice in

                  SCAN1)  scan1 ;;
                  SCAN2)  scan2 ;;
                  SCAN3)  scan3 ;;
                  SCAN4)  scan4 ;;
                  SCAN5)  scan5 ;;
                  WTF1)   WTF;;
                  RTF1)   RTF ;;
                  CMD1)   CMD ;;
                  EXIT)   clear; exit 0;;
              esac ;; 

          *)clear ; exit ;;
    esac

done       
